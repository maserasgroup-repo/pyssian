
<!DOCTYPE html>

<html lang="python">
  <head>
    <meta charset="utf-8" />
    <title>pyssian.gaussianclasses &#8212; pyssian  documentation</title>
    <link rel="stylesheet" href="../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">pyssian  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for pyssian.gaussianclasses</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">One of the two core libraries of pyssian. Contains the Classes that represent</span>
<span class="sd">Gaussian Files (input and output).</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">io</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">chain</span>

<span class="kn">from</span> <span class="nn">.chemistryutils</span> <span class="kn">import</span> <span class="n">is_method</span><span class="p">,</span> <span class="n">is_basis</span>
<span class="kn">from</span> <span class="nn">.linkjobparsers</span> <span class="kn">import</span> <span class="n">LinkJob</span><span class="p">,</span> <span class="n">GeneralLinkJob</span>

<span class="c1"># Pre-Initialized dictionary for the GaussianOutFile.Parse</span>
<span class="n">Available_Linkjobs</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span><span class="n">GeneralLinkJob</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10000</span><span class="p">)}</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">LinkJob</span><span class="o">.</span><span class="n">Register</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">Available_Linkjobs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">LinkJob</span><span class="o">.</span><span class="n">Register</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>


<div class="viewcode-block" id="GaussianOutFile"><a class="viewcode-back" href="../../pyssian.gaussianclasses.html#pyssian.GaussianOutFile">[docs]</a><span class="k">class</span> <span class="nc">GaussianOutFile</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Gaussian 09 .out file parent class, if any special type of calculation</span>
<span class="sd">    requires different processing it should be a subclass of this one. Accepts</span>
<span class="sd">    a context manager usage similar to &#39;with open(file) as F:...&#39;</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file : io.TextIOBase or str</span>
<span class="sd">        File instance (Result of open(filename,&#39;r&#39;)) or valid filename.</span>
<span class="sd">    parselist : list</span>
<span class="sd">        List of integrers that represent which types of Links to parse</span>
<span class="sd">        (the default is None).</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    InternalJobs</span>
<span class="sd">        List of InternalJobs done by gaussian i.e an gaussian calculation with</span>
<span class="sd">        the opt freq keywords will run first an InternalJob for the Optimization</span>
<span class="sd">        and after an InternalJob for the Frequency calculation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_interblock</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>        <span class="c1"># interblock token</span>
    <span class="n">_EOF</span> <span class="o">=</span> <span class="o">-</span><span class="mi">9999</span>            <span class="c1"># EOF token</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">file</span><span class="p">,</span><span class="n">parselist</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">cls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">InternalJobs</span> <span class="o">=</span> <span class="p">[</span><span class="n">InternalJob</span><span class="p">(),]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="n">io</span><span class="o">.</span><span class="n">TextIOBase</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_file</span> <span class="o">=</span> <span class="n">file</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">parselist</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">parselist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Access the dictionary that holds the constructors for each LinkJob</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_SetParsers</span><span class="p">(</span><span class="n">parselist</span><span class="p">,</span><span class="bp">cls</span><span class="o">.</span><span class="n">_interblock</span><span class="p">)</span>
        <span class="c1"># Initialize the generators/coroutines</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_BlockFetcher</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">BlockFetcher</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_EOF</span><span class="p">,</span><span class="bp">cls</span><span class="o">.</span><span class="n">_interblock</span><span class="p">)</span>
        <span class="n">_</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_BlockFetcher</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_BlockHandler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">BlockHandler</span><span class="p">()</span>
        <span class="n">_</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_BlockHandler</span><span class="p">)</span>
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">cls</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="nb">repr</span> <span class="o">=</span> <span class="s1">&#39;&lt;</span><span class="si">{cls}</span><span class="s1">(</span><span class="si">{file}</span><span class="s1">)&gt; with </span><span class="si">{size}</span><span class="s1"> InternalJobs&#39;</span>
        <span class="k">return</span> <span class="nb">repr</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">=</span><span class="bp">cls</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">cls</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="nb">repr</span> <span class="o">=</span> <span class="s1">&#39;&lt;</span><span class="si">{cls}</span><span class="s1">(</span><span class="si">{file}</span><span class="s1">)&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">=</span><span class="bp">cls</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">InternalJob</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="nb">repr</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span><span class="o">*</span><span class="mi">4</span><span class="o">+</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> type &lt;</span><span class="si">{0.type}</span><span class="s1">&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">InternalJob</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">Link</span> <span class="ow">in</span> <span class="n">InternalJob</span><span class="p">:</span>
                 <span class="nb">repr</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span><span class="o">*</span><span class="mi">8</span><span class="o">+</span><span class="s1">&#39;</span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Link</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">repr</span>
    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">InternalJobs</span><span class="p">)</span>
    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">index</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">InternalJobs</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Wrapper to have similar behaviour to &quot;_io.TextIOWrapper&quot; &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span>
    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">,</span> <span class="n">traceback</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Wrapper to have similar behaviour to &quot;_io.TextIOWrapper&quot; &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="o">.</span><span class="fm">__exit__</span><span class="p">(</span><span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">,</span> <span class="n">traceback</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_SetParsers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ParseList</span><span class="p">,</span><span class="n">interblock</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">Parsers</span> <span class="o">=</span> <span class="n">Available_Linkjobs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">assert</span> <span class="n">interblock</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">Parsers</span>
        <span class="k">if</span> <span class="n">ParseList</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ParseList</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="c1"># flag to parse all as empty</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">Parsers</span><span class="p">:</span>
                    <span class="n">Parsers</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">Parsers</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">as_empty</span>
            <span class="k">else</span><span class="p">:</span> <span class="c1"># Set up the appropiate parsers</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">Parsers</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ParseList</span><span class="p">:</span>
                        <span class="n">Parsers</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">Parsers</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">as_empty</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1"># Parse all normally</span>
            <span class="k">pass</span>
        <span class="n">Parsers</span><span class="p">[</span><span class="n">interblock</span><span class="p">]</span> <span class="o">=</span> <span class="n">GeneralLinkJob</span><span class="o">.</span><span class="n">as_empty</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Parsers</span> <span class="o">=</span> <span class="n">Parsers</span>
<div class="viewcode-block" id="GaussianOutFile.FileStructure"><a class="viewcode-back" href="../../pyssian.gaussianclasses.html#pyssian.GaussianOutFile.FileStructure">[docs]</a>    <span class="k">def</span> <span class="nf">FileStructure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Display the structure of links and internal jobs of the file.&quot;&quot;&quot;</span>
        <span class="n">spacer</span> <span class="o">=</span> <span class="s2">&quot;  &quot;</span>
        <span class="n">Result</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{!r}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">intjob</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">Result</span> <span class="o">+=</span> <span class="n">spacer</span><span class="o">*</span><span class="mi">1</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{!r}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">intjob</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">intjob</span><span class="p">:</span>
                <span class="n">Result</span> <span class="o">+=</span> <span class="n">spacer</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{!r}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">link</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">Result</span><span class="p">)</span></div>
<div class="viewcode-block" id="GaussianOutFile.read"><a class="viewcode-back" href="../../pyssian.gaussianclasses.html#pyssian.GaussianOutFile.read">[docs]</a>    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Alias of update for consistency with GaussianInFile class&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span></div>
    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Alias to file.close for consistency with the io.TextIOBase class&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<div class="viewcode-block" id="GaussianOutFile.update"><a class="viewcode-back" href="../../pyssian.gaussianclasses.html#pyssian.GaussianOutFile.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">clean</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">FinalPrint</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Tries to fetch new data. If it exists it parses it appropiately</span>
<span class="sd">        otherwise it fails silently.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        clean : Bool</span>
<span class="sd">            If True removes all the EmptyLinkJobs found (the default is True).</span>
<span class="sd">        FinalPrint : Bool</span>
<span class="sd">            If True after a normal execution has finished it will print in the</span>
<span class="sd">            console a message to notify the user (the default is False).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">cls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span>
        <span class="n">BlockFetcher</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_BlockFetcher</span>
        <span class="n">BlockHandler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_BlockHandler</span>
        <span class="n">BlockType</span><span class="p">,</span> <span class="n">Block</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">BlockFetcher</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">BlockType</span> <span class="o">!=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_EOF</span><span class="p">:</span>
            <span class="n">BlockHandler</span><span class="o">.</span><span class="n">send</span><span class="p">((</span><span class="n">BlockType</span><span class="p">,</span> <span class="n">Block</span><span class="p">))</span>
            <span class="n">BlockType</span><span class="p">,</span> <span class="n">Block</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">BlockFetcher</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">InternalJobs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">number</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">InternalJobs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">GuessInfo</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">clean</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">FinalPrint</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> UPDATED&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()))</span></div>
<div class="viewcode-block" id="GaussianOutFile.clean"><a class="viewcode-back" href="../../pyssian.gaussianclasses.html#pyssian.GaussianOutFile.clean">[docs]</a>    <span class="k">def</span> <span class="nf">clean</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Removes per each InternalJob stored all the EmptyLinkJobs.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">InternalJob</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">InternalJobs</span><span class="p">:</span>
            <span class="n">InternalJob</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span></div>
<div class="viewcode-block" id="GaussianOutFile.GetLinks"><a class="viewcode-back" href="../../pyssian.gaussianclasses.html#pyssian.GaussianOutFile.GetLinks">[docs]</a>    <span class="k">def</span> <span class="nf">GetLinks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">LinkIds</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wrapper Method to get a list of Links with certain Ids across</span>
<span class="sd">        the different Internal Jobs.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *LinkIds : int</span>
<span class="sd">            Integrers that correspond to the type of links to be return.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">LinkLists</span> <span class="o">=</span> <span class="p">[</span><span class="n">IntJob</span><span class="o">.</span><span class="n">GetLinks</span><span class="p">(</span><span class="o">*</span><span class="n">LinkIds</span><span class="p">)</span> <span class="k">for</span> <span class="n">IntJob</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">InternalJobs</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">LinkLists</span><span class="p">))</span></div>
    <span class="c1"># Generators and Coroutines for File Parsing</span>
    <span class="k">def</span> <span class="nf">Reader</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">file</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Generator for line by line reading without stopiteration &quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">Pos_old</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">Pos_new</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
            <span class="n">ReachedEOF</span> <span class="o">=</span> <span class="n">Pos_old</span> <span class="o">==</span> <span class="n">Pos_new</span>
            <span class="k">yield</span> <span class="n">ReachedEOF</span><span class="p">,</span><span class="n">line</span>
    <span class="k">def</span> <span class="nf">BlockFetcher</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">EOF</span><span class="o">=-</span><span class="mi">9999</span><span class="p">,</span><span class="n">interblock</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generator that yields the text sliced in blocks and their type.</span>

<span class="sd">        A block is an iterable of strings and its type refers to a token that</span>
<span class="sd">        can be recognized by the ._Parsers variable, something in betweem</span>
<span class="sd">        Link Blocks (interblock=-1) or no end was found (EOF=-9999)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Regex generation</span>
        <span class="n">re_enter</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(?:Enter.*l)([0-9]{1,4})(?:\.exe)&#39;</span><span class="p">)</span>
        <span class="n">re_exit</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(?:Leave\s*Link\s*)([0-9]{1,4})&#39;</span><span class="p">)</span>
        <span class="n">re_termination</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\s?([a-zA-Z]*)\stermination&#39;</span><span class="p">)</span>

        <span class="c1"># Initialize the Reader generator</span>
        <span class="n">Reader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Reader</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="p">)</span>

        <span class="k">yield</span> <span class="s1">&#39;Initialization done&#39;</span>
        <span class="c1"># If more than 1 EndKeyws then BlockType Assesment has to be modified</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">Block</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="c1"># Ask the Reader until a &quot;start line&quot; is found</span>
            <span class="k">while</span> <span class="ow">not</span> <span class="n">start</span><span class="p">:</span>
                <span class="n">ReachedEOF</span><span class="p">,</span><span class="n">line</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">Reader</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ReachedEOF</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="n">EOF</span><span class="p">,</span> <span class="s1">&#39;&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">start</span> <span class="o">=</span> <span class="n">re_enter</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">start</span><span class="p">:</span>
                        <span class="n">Block</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span> <span class="c1"># Store the number of the Link</span>
                        <span class="n">number</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">start</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="c1"># When found yield it as a &quot;InterBlock&quot; and prepare Block</span>
            <span class="k">if</span> <span class="n">Block</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">interblock</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Block</span><span class="p">)</span>
                <span class="n">Block</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="p">,]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">Block</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="c1"># Now that the start of the Link has been found, accumulate lines</span>
            <span class="c1">## until the end or termination line is found</span>
            <span class="n">end</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">while</span> <span class="ow">not</span> <span class="n">end</span><span class="p">:</span>
                <span class="n">ReachedEOF</span><span class="p">,</span><span class="n">line</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">Reader</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ReachedEOF</span><span class="p">:</span>
                    <span class="n">Target</span> <span class="o">=</span> <span class="n">Block</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">:]</span> <span class="o">+</span> <span class="p">[</span><span class="n">line</span><span class="p">,]</span>
                    <span class="n">terminated</span> <span class="o">=</span> <span class="n">re_termination</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Target</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">terminated</span><span class="p">:</span>
                        <span class="n">Block</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                        <span class="c1">#if terminated[0] == &#39;Normal&#39;:</span>
                        <span class="c1">#    other = str(BlockTypes[Termination_key])</span>
                        <span class="c1">#elif terminated[0] == &#39;Error&#39;:</span>
                        <span class="c1">#    other = str(BlockTypes[Error_key])</span>
                        <span class="k">break</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">yield</span> <span class="n">EOF</span><span class="p">,</span> <span class="s1">&#39;&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">end</span> <span class="o">=</span> <span class="n">re_exit</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="n">Block</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="c1"># when end found, do return type token and yield the block</span>
            <span class="k">yield</span> <span class="n">number</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Block</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">BlockHandler</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Coroutine. Receives a block, chooses the parser and parses it &quot;&quot;&quot;</span>
        <span class="c1"># Initialization</span>
        <span class="n">Parsers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Parsers</span>
        <span class="n">CurrentJob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">InternalJobs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">BlockType</span><span class="p">,</span> <span class="n">Block</span> <span class="o">=</span> <span class="k">yield</span> <span class="s1">&#39;Initialization done&#39;</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="c1">#Parser = Parsers.get(BlockType,Parsers[ignore])</span>
            <span class="n">Parser</span> <span class="o">=</span> <span class="n">Parsers</span><span class="p">[</span><span class="n">BlockType</span><span class="p">]</span>
            <span class="n">Link</span> <span class="o">=</span>  <span class="n">Parser</span><span class="p">(</span><span class="n">Block</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">Link</span><span class="o">.</span><span class="n">number</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">new_InternalJob</span> <span class="o">=</span> <span class="n">Link</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">new_InternalJob</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_InternalJob</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">new_InternalJob</span><span class="p">:</span>
                <span class="n">New</span> <span class="o">=</span> <span class="n">InternalJob</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">InternalJobs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">New</span><span class="p">)</span>
                <span class="n">CurrentJob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">InternalJobs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">CurrentJob</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Link</span><span class="p">)</span>
                <span class="n">CurrentJob</span><span class="o">.</span><span class="n">GuessInfo</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">CurrentJob</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Link</span><span class="p">)</span>
            <span class="n">BlockType</span><span class="p">,</span> <span class="n">Block</span> <span class="o">=</span> <span class="k">yield</span></div>

<div class="viewcode-block" id="InternalJob"><a class="viewcode-back" href="../../pyssian.gaussianclasses.html#pyssian.InternalJob">[docs]</a><span class="k">class</span> <span class="nc">InternalJob</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Gaussian 09 InternalJob parent class, if any special type of Job</span>
<span class="sd">    requires different parsing it should be a subclass of this one.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    number : int</span>
<span class="sd">        ordinal number of the InternalJob (the default is None).</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    type</span>
<span class="sd">        string identifier for the job.</span>
<span class="sd">    Links</span>
<span class="sd">        List of the different Links that belong to the InternalJob.</span>
<span class="sd">    number</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">number</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="n">number</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Links</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">cls</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">number</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&lt;</span><span class="si">{cls}</span><span class="s1"> Created but Empty&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">=</span><span class="bp">cls</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&lt;</span><span class="si">{cls}</span><span class="s1"> </span><span class="si">{number}</span><span class="s1">&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">=</span><span class="bp">cls</span><span class="p">,</span><span class="n">number</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Internal Job </span><span class="si">{0.number}</span><span class="s1">: </span><span class="si">{0.type}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">index</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Links</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Links</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Link</span><span class="p">):</span>
        <span class="c1"># Restrict to Link objects</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Link</span><span class="p">,</span> <span class="n">LinkJob</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{r}</span><span class="s1"> is not of class </span><span class="si">{r}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Link</span><span class="p">,</span><span class="n">LinkJob</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Link</span><span class="p">)</span>
<div class="viewcode-block" id="InternalJob.GuessInfo"><a class="viewcode-back" href="../../pyssian.gaussianclasses.html#pyssian.InternalJob.GuessInfo">[docs]</a>    <span class="k">def</span> <span class="nf">GuessInfo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Guesses the number and type attributes of itself using the stored</span>
<span class="sd">        Links.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Links</span><span class="p">:</span>
            <span class="n">Links</span> <span class="o">=</span> <span class="p">(</span><span class="n">Link</span> <span class="k">for</span> <span class="n">Link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Links</span> <span class="k">if</span> <span class="n">Link</span><span class="o">.</span><span class="n">number</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">StarterLink</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">Links</span><span class="p">)</span>
                <span class="n">info</span> <span class="o">=</span> <span class="n">StarterLink</span><span class="o">.</span><span class="n">info</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">number</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">type</span></div>
<div class="viewcode-block" id="InternalJob.clean"><a class="viewcode-back" href="../../pyssian.gaussianclasses.html#pyssian.InternalJob.clean">[docs]</a>    <span class="k">def</span> <span class="nf">clean</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Removes all the Empty Link instances within Links.&quot;&quot;&quot;</span>
        <span class="n">Indices2Remove</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">Link</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Links</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">Link</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
                <span class="n">Indices2Remove</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">Indices2Remove</span><span class="p">):</span>
            <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Links</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">index</span><span class="p">)</span></div>
<div class="viewcode-block" id="InternalJob.GetLinks"><a class="viewcode-back" href="../../pyssian.gaussianclasses.html#pyssian.InternalJob.GetLinks">[docs]</a>    <span class="k">def</span> <span class="nf">GetLinks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">LinkIds</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wrapper Method to get a list of Links with certain Ids.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *LinkIds : int</span>
<span class="sd">            Integrers that correspond to the type of links to be return.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">            List of Link Objects ordered by appearance in the file and filtered</span>
<span class="sd">            by Link Number.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">Link</span> <span class="k">for</span> <span class="n">Link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Links</span> <span class="k">if</span> <span class="n">Link</span><span class="o">.</span><span class="n">number</span> <span class="ow">in</span> <span class="n">LinkIds</span><span class="p">]</span></div></div>

<div class="viewcode-block" id="GaussianInFile"><a class="viewcode-back" href="../../pyssian.gaussianclasses.html#pyssian.GaussianInFile">[docs]</a><span class="k">class</span> <span class="nc">GaussianInFile</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gaussian 09 .in file parent class, if any special type of input</span>
<span class="sd">    requires different processing it should be a subclass of this one.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file : io.TextIOBase or str</span>
<span class="sd">        File instance (Result of open(filename,&#39;r&#39;)) or valid filename.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    preprocessing : dict</span>
<span class="sd">        Dictionary in which each key corresponds to a certain Link0 keyword</span>
<span class="sd">    commandline : dict</span>
<span class="sd">        Dictionary that contains the information of how the calculation</span>
<span class="sd">        will be carried out.</span>
<span class="sd">    title : str</span>
<span class="sd">        title of the calculation.</span>
<span class="sd">    method : str</span>
<span class="sd">        If it cannot be recognized in the command line it will be empty.</span>
<span class="sd">    basis : str</span>
<span class="sd">        If it cannot be recognized in the command line it will be empty.</span>
<span class="sd">    spin : int</span>
<span class="sd">    charge : int</span>
<span class="sd">    geometry : str-ish</span>
<span class="sd">        It should be able to write the text block of an input file upon calling</span>
<span class="sd">        str(geometry)</span>
<span class="sd">    tail : list</span>
<span class="sd">        List of str in which each should be separated from the others by a</span>
<span class="sd">        single blank line in the input file.</span>
<span class="sd">    structure : str</span>
<span class="sd">        A string holding the structure of the input file. Used to write new</span>
<span class="sd">        Input files.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">file</span><span class="p">):</span>
        <span class="c1"># Do Something</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="n">io</span><span class="o">.</span><span class="n">TextIOBase</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_file</span> <span class="o">=</span> <span class="n">file</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="s1">&#39;a+&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_txt</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preprocessing</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span> <span class="c1"># In the G16 Manual &quot;Link 0 Commands&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">commandline</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span> <span class="c1"># In the G16 Manual &quot;Route Section&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_method</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_basis</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spin</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">charge</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="c1"># In the G16 Manual &quot;Molecule Specification&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tail</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># In the G16 Manual &quot;Optional additional sections&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">structure</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{preprocessing}</span><span class="se">\n</span><span class="si">{commandline}</span><span class="se">\n\n</span><span class="s1">&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">structure</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{title}</span><span class="se">\n\n</span><span class="s1">&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">structure</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{charge}</span><span class="s1"> </span><span class="si">{spin}</span><span class="se">\n</span><span class="si">{geometry}</span><span class="se">\n\n</span><span class="s1">&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">structure</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{tail}</span><span class="se">\n\n</span><span class="s1">&#39;</span>
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">cls</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="nb">repr</span> <span class="o">=</span> <span class="s1">&#39;&lt;</span><span class="si">{cls}</span><span class="s1">(</span><span class="si">{file}</span><span class="s1">)&gt;&#39;</span>
        <span class="k">return</span> <span class="nb">repr</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">=</span><span class="bp">cls</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># str repr of the preprocessing</span>
        <span class="n">preprocessing</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">val</span><span class="p">:</span>
                <span class="n">Aux</span> <span class="o">=</span> <span class="s1">&#39;%</span><span class="si">{0}</span><span class="s1">=</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="n">val</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">Aux</span> <span class="o">=</span> <span class="s1">&#39;%</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="n">preprocessing</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Aux</span><span class="p">)</span>
        <span class="c1"># str repr of the commandline</span>
        <span class="n">commandline</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#p&#39;</span><span class="p">,]</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">commandline</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">val</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">Aux</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">=</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">val</span><span class="p">:</span>
                <span class="n">Aux</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">=(</span><span class="si">{1}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">Aux</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="n">commandline</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Aux</span><span class="p">)</span>
        <span class="c1"># Prepare to format as str</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="n">preprocessing</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">preprocessing</span><span class="p">),</span>
                       <span class="n">commandline</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">commandline</span><span class="p">),</span>
                       <span class="n">title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">,</span>
                       <span class="n">charge</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">charge</span><span class="p">,</span>
                       <span class="n">spin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">spin</span><span class="p">,</span>
                       <span class="n">geometry</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="p">),</span>
                       <span class="n">tail</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tail</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Wrapper to have similar behaviour to &quot;_io.TextIOWrapper&quot; &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span>
    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">,</span> <span class="n">traceback</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Wrapper to have similar behaviour to &quot;_io.TextIOWrapper&quot; &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="o">.</span><span class="fm">__exit__</span><span class="p">(</span><span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">,</span> <span class="n">traceback</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_method</span>
    <span class="nd">@method</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">change_method</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">basis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_basis</span>
    <span class="nd">@basis</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">basis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">change_basis</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nprocs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nprocs&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
    <span class="nd">@nprocs</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">nprocs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preprocessing</span><span class="p">[</span><span class="s1">&#39;nprocs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">other</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">mem</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mem&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
    <span class="nd">@mem</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">mem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preprocessing</span><span class="p">[</span><span class="s1">&#39;mem&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">other</span>

<div class="viewcode-block" id="GaussianInFile.read"><a class="viewcode-back" href="../../pyssian.gaussianclasses.html#pyssian.GaussianInFile.read">[docs]</a>    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads the file and populates the appropiate attributes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">txt</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">txt</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span> <span class="c1"># If the file ends without a blank line add it</span>
            <span class="n">txt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">txt</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]:</span> <span class="c1"># If the file ends without two blank lines add one</span>
            <span class="n">txt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_txt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
        <span class="n">bins</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">]</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="n">bins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">header</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">txt</span><span class="p">[:</span><span class="n">stop</span><span class="p">])</span>
        <span class="n">preprocessing</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">header</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;%&quot;</span><span class="p">):</span>
                <span class="n">preprocessing</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s2">&quot;%&quot;</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">):</span>
                <span class="k">break</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parse_preprocessing</span><span class="p">(</span><span class="n">preprocessing</span><span class="p">)</span>

        <span class="c1"># Read the command line assuming that the keywords cannot be in a</span>
        <span class="c1"># &#39;chopped in half&#39; version between lines</span>
        <span class="n">commandline</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(),]</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">header</span><span class="p">:</span>
            <span class="n">commandline</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parse_commandline</span><span class="p">(</span><span class="n">commandline</span><span class="p">)</span>

        <span class="c1"># Read the Title Section</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">bins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="n">bins</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">title</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">txt</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

        <span class="c1"># Read charge and spin</span>
        <span class="n">charge</span><span class="p">,</span><span class="n">spin</span> <span class="o">=</span> <span class="n">txt</span><span class="p">[</span><span class="n">stop</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">charge</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">spin</span>  <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">charge</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">spin</span><span class="p">)</span>

        <span class="c1"># Now we read the geometry</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">stop</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="n">bins</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">geometry</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">txt</span><span class="p">[</span><span class="n">start</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">stop</span><span class="p">]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parse_geometry</span><span class="p">(</span><span class="n">geometry</span><span class="p">)</span>

        <span class="c1"># Now we read the Tail</span>
        <span class="n">tail</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">stop</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span> <span class="c1"># if it exists</span>
            <span class="n">tail</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">txt</span><span class="p">[</span><span class="n">stop</span><span class="p">:]]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parse_tail</span><span class="p">(</span><span class="n">tail</span><span class="p">)</span></div>
<div class="viewcode-block" id="GaussianInFile.close"><a class="viewcode-back" href="../../pyssian.gaussianclasses.html#pyssian.GaussianInFile.close">[docs]</a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Alias to file.close for consistency with the io.TextIOBase class&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
<div class="viewcode-block" id="GaussianInFile.write"><a class="viewcode-back" href="../../pyssian.gaussianclasses.html#pyssian.GaussianInFile.write">[docs]</a>    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">filepath</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes the the File object to a File. If a filepath is provided it will</span>
<span class="sd">        write to that filepath otherwise it will attempt to write to the path</span>
<span class="sd">        provided in the initialization.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filepath : str</span>
<span class="sd">            A valid filepath.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_txt</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">filepath</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Write to self._file</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_txt</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># open the file write and close the file</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">F</span><span class="p">:</span>
                <span class="n">F</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_txt</span><span class="p">)</span></div>

    <span class="c1"># Helper Functions for the read function to encapsulate different behaviours</span>
<div class="viewcode-block" id="GaussianInFile.parse_preprocessing"><a class="viewcode-back" href="../../pyssian.gaussianclasses.html#pyssian.GaussianInFile.parse_preprocessing">[docs]</a>    <span class="k">def</span> <span class="nf">parse_preprocessing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">lines</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parses the lines that contain the Link 0 keywords and transforms them</span>
<span class="sd">        into a dictionary representation.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        lines : list</span>
<span class="sd">            list of strings previously stripped. Empty lines will be ignored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#The logic of the specification of the preprocessing is below</span>
        <span class="c1">## %kwd=something (most of the keywords follow this shape)</span>
        <span class="c1">## %kwd           (Few keywords follow this shape)</span>
        <span class="c1">## %kwd L{number} [something,or not] (2 kewyords follow this shape)</span>
        <span class="c1"># As initial design criteria I&#39;m reducing the third case to the second</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="n">Aux</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Aux</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">key</span><span class="p">,</span><span class="n">val</span> <span class="o">=</span> <span class="n">Aux</span><span class="p">,</span><span class="s1">&#39;&#39;</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">Aux</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">key</span><span class="p">,</span><span class="n">val</span> <span class="o">=</span> <span class="n">Aux</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">preprocessing</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span></div>
<div class="viewcode-block" id="GaussianInFile.parse_commandline"><a class="viewcode-back" href="../../pyssian.gaussianclasses.html#pyssian.GaussianInFile.parse_commandline">[docs]</a>    <span class="k">def</span> <span class="nf">parse_commandline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">lines</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parses the lines that contain the calculation commands kewords and</span>
<span class="sd">        transforms them into a dictionary representation.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        lines : list</span>
<span class="sd">            list of strings previously stripped. Empty lines will be ignored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># the first line contains the &quot;#p&quot;, remove it</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">others</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>
        <span class="n">method_found</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">basis_found</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">chain</span><span class="p">(</span><span class="n">start</span><span class="p">,</span><span class="n">others</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">is_method</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">method_found</span><span class="p">:</span>
                <span class="n">method_found</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_method</span> <span class="o">=</span> <span class="n">item</span>
                <span class="n">key</span><span class="p">,</span><span class="n">val</span> <span class="o">=</span> <span class="n">item</span><span class="p">,</span> <span class="p">[]</span>
            <span class="k">elif</span> <span class="n">is_basis</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">basis_found</span><span class="p">:</span>
                <span class="n">basis_found</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_basis</span> <span class="o">=</span> <span class="n">item</span>
                <span class="n">key</span><span class="p">,</span><span class="n">val</span> <span class="o">=</span> <span class="n">item</span><span class="p">,</span> <span class="p">[]</span>
            <span class="k">elif</span> <span class="n">is_basis</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="ow">or</span> <span class="n">is_method</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;2 Basis or methods found </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;taking </span><span class="si">{}</span><span class="s1"> as a normal keyword&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
                <span class="n">key</span><span class="p">,</span><span class="n">val</span> <span class="o">=</span> <span class="n">item</span><span class="p">,</span> <span class="p">[]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">Aux</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Aux</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">key</span><span class="p">,</span><span class="n">val</span> <span class="o">=</span> <span class="n">Aux</span><span class="p">[</span><span class="mi">0</span><span class="p">],[]</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">Aux</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">key</span><span class="p">,</span><span class="n">val</span> <span class="o">=</span> <span class="n">Aux</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">pass</span> <span class="c1"># Should only enter with empty items</span>
                <span class="k">if</span> <span class="n">val</span> <span class="ow">and</span> <span class="n">val</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">):</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">val</span><span class="p">:</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="p">,]</span>
            <span class="n">previously_stored</span> <span class="o">=</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">commandline</span>
            <span class="n">has_suboptions</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">commandline</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="kc">False</span><span class="p">))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">previously_stored</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">commandline</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">has_suboptions</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">commandline</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">Aux3</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">commandline</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> <span class="o">+</span> <span class="nb">set</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">commandline</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">Aux3</span><span class="p">)</span></div>
<div class="viewcode-block" id="GaussianInFile.parse_geometry"><a class="viewcode-back" href="../../pyssian.gaussianclasses.html#pyssian.GaussianInFile.parse_geometry">[docs]</a>    <span class="k">def</span> <span class="nf">parse_geometry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">lines</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parses each line that contains &#39;Atom x y z&#39; in an appropiate form</span>
<span class="sd">        and saves it to self.geometry</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        lines : list</span>
<span class="sd">            list of strings previously stripped. Should not contain empty lines</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># This function is currently set up to only get the geometry as is.</span>
        <span class="c1"># In the future it should include the logic to transform between</span>
        <span class="c1"># coordinate specifications  (zmatrix,xyz,internal) to enforce a certain</span>
        <span class="c1"># geometry or geometry class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span></div>
<div class="viewcode-block" id="GaussianInFile.parse_tail"><a class="viewcode-back" href="../../pyssian.gaussianclasses.html#pyssian.GaussianInFile.parse_tail">[docs]</a>    <span class="k">def</span> <span class="nf">parse_tail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">lines</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Chops the set of lines into different blocks of text using as</span>
<span class="sd">        reference the emptylines/blank lines</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        lines : list</span>
<span class="sd">            list of strings previously stripped.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        type</span>
<span class="sd">            Description of returned object.</span>

<span class="sd">        Raises</span>
<span class="sd">        -------</span>
<span class="sd">        ExceptionName</span>
<span class="sd">            Why the exception is raised.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Aux</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tail</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">line</span><span class="p">:</span>
                <span class="n">Aux</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">Aux</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tail</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Aux</span><span class="p">))</span>
                <span class="n">Aux</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Aux</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tail</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Aux</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Parsed an input file withouth blank line ending&#39;</span><span class="p">)</span></div>


    <span class="c1"># Modifying functions</span>
<div class="viewcode-block" id="GaussianInFile.pop_chk"><a class="viewcode-back" href="../../pyssian.gaussianclasses.html#pyssian.GaussianInFile.pop_chk">[docs]</a>    <span class="k">def</span> <span class="nf">pop_chk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes the chk from the file, returns &#39;default&#39; if the chk was not</span>
<span class="sd">        included already</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;chk&#39;</span><span class="p">,</span><span class="n">default</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;chk&#39;</span><span class="p">)</span></div>
<div class="viewcode-block" id="GaussianInFile.add_chk"><a class="viewcode-back" href="../../pyssian.gaussianclasses.html#pyssian.GaussianInFile.add_chk">[docs]</a>    <span class="k">def</span> <span class="nf">add_chk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds the chk to the file, with the specified name. If none is provided</span>
<span class="sd">        defaults to the file name ended in .chk</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Adds the chk to the file</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="o">.</span><span class="n">name</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;.chk&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.chk&#39;</span><span class="p">):</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="o">+</span><span class="s1">&#39;.chk&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preprocessing</span><span class="p">[</span><span class="s1">&#39;chk&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">name</span></div>
<div class="viewcode-block" id="GaussianInFile.change_method"><a class="viewcode-back" href="../../pyssian.gaussianclasses.html#pyssian.GaussianInFile.change_method">[docs]</a>    <span class="k">def</span> <span class="nf">change_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">method</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Changes appropiately the method of the calculation. Equivalent to</span>
<span class="sd">        self.method = method</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        method : str</span>
<span class="sd">            A string representation of a valid method</span>

<span class="sd">        Raises</span>
<span class="sd">        -------</span>
<span class="sd">        NotImplementedError</span>
<span class="sd">            If the method is not within the registered methods keywords</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_method</span><span class="p">(</span><span class="n">method</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;method </span><span class="si">{}</span><span class="s1"> not implemented&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">method</span><span class="p">))</span>
        <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_method</span>
        <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">commandline</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span> <span class="c1"># Used to ensure deletion of the key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_method</span> <span class="o">=</span> <span class="n">method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">commandline</span><span class="p">[</span><span class="n">method</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span></div>
<div class="viewcode-block" id="GaussianInFile.change_basis"><a class="viewcode-back" href="../../pyssian.gaussianclasses.html#pyssian.GaussianInFile.change_basis">[docs]</a>    <span class="k">def</span> <span class="nf">change_basis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">basis</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Changes appropiately the basis of the calculation. Equivalent to</span>
<span class="sd">        self.basis = basis.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        basis : str</span>
<span class="sd">            A string representation of a valid method if specified in the</span>
<span class="sd">            command line.</span>

<span class="sd">        Raises</span>
<span class="sd">        -------</span>
<span class="sd">        NotImplementedError</span>
<span class="sd">            If the basis is not within the registered basis keywords</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_basis</span><span class="p">(</span><span class="n">basis</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;basis </span><span class="si">{}</span><span class="s1"> not implemented&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">basis</span><span class="p">))</span>
        <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_basis</span>
        <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">commandline</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span> <span class="c1"># Used to ensure deletion of the key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_basis</span> <span class="o">=</span> <span class="n">basis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">commandline</span><span class="p">[</span><span class="n">basis</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span></div></div>

<span class="c1"># Idea: Implement a class to read and manipulate the basis functions in the tail</span>
<span class="c1"># class BasisTail(object), whose str function returns things as it should and</span>
<span class="c1"># that can have a linked input file object, so that modifying the basis of this</span>
<span class="c1"># object will modify the input file basis in certain cases.</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">pyssian  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, rperezsoto.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.0.3.
    </div>
  </body>
</html>